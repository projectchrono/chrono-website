<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.11"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>Project Chrono: Gear constraint example (demo_gears.cpp)</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://projectchrono.org">
            <span class="logo first">PROJECT</span><span class="logo second">CHRONO</span>
        </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="http://projectchrono.org/download">Download</a></li>
        <li class="dropdown">
            <a href="http://api.chrono.projectchrono.org" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://api.chrono.projectchrono.org/faq_root.html">FAQ</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_table_of_content_install.html">Install Guide</a></li>
                <li><a href="http://api.chrono.projectchrono.org/tutorial_root.html">Examples/Tutorials</a></li>
                <li><a href="http://api.chrono.projectchrono.org/model_root.html">Model Library</a></li>
                <li><a href="http://api.chrono.projectchrono.org/validation_studies_root.html">Validation Studies</a></li>
                <li><a href="http://api.chrono.projectchrono.org/whitepaper_root.html">White Papers</a></li>
                <li><a href="http://projectchrono.org/docpdf">PDF Version</a></li>
            </ul>
        </li>
        <li class="dropdown">
            <a href="http://projectchrono.org/gallery/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" style="dropdown:hover" aria-haspopup="true" aria-expanded="false">Movies <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/gallery/">Gallery</a></li>
                <li><a href="http://sbel.wisc.edu/Animations/">SBEL</a></li>
                <li><a href="https://vimeo.com/uwsbel">On Vimeo</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/news/">News</a></li>
        <li><a href="http://projectchrono.org/forum">Forum</a></li>
		<li class="dropdown">
            <a href="http://projectchrono.org/about/" class="dropdown-toggle disabled" data-hover="dropdown" data-toggle="dropdown" data-delay="100" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
            <ul class="dropdown-menu">
                <li><a href="http://projectchrono.org/about/">What is ProjectChrono</a></li>
                <li><a href="http://projectchrono.org/testimonials/">Users</a></li>
            </ul>
        </li>
        <li><a href="http://projectchrono.org/status">Status</a></li>            
            <li>
              <form method="get" action="http://projectchrono.org/search" id="search_bar_triggered">
                          <input type="submit" value="Search">
                <input type="text" id="search_bar" name="query" value="" />
              </form> 
            </li>
    </ul>
          <!-- <ul class="nav navbar-nav navbar-right">
      </ul> -->
  </div><!--/.navbar-collapse -->
</div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Project Chrono API/SDK documentation</a></li><li class="navelem"><a class="el" href="manual_root.html">Reference Manual</a></li><li class="navelem"><a class="el" href="tutorial_root.html">Tutorials</a></li><li class="navelem"><a class="el" href="tutorial_table_of_content_chrono_irrlicht.html">Chrono IRRLICHT module tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Gear constraint example (demo_gears.cpp) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Create a transmission made of pulleys, spur gears, bevel gears.</p>
<p>Custom simplified constraints are available, to avoid the simulation of contacts between gear teeth.</p>
<p>This tutorial shows how to:</p>
<ul>
<li>use ChLinkGear constraints to represent simplified gear interaction in 3D space</li>
<li>the ChLinkPulley constraint is used to model simplified pulleys in 3D space.</li>
<li>manage rotations of references using ChCoordsys and ChFrame classes.</li>
<li>create a motor between two parts.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// PROJECT CHRONO - http://projectchrono.org</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Copyright (c) 2010-2011 Alessandro Tasora</span></div><div class="line"><span class="comment">// All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div><div class="line"><span class="comment">// found in the LICENSE file at the top level of the distribution</span></div><div class="line"><span class="comment">// and at http://projectchrono.org/license-chrono.txt.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   Demo code about</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     - gear constraint (ChLinkGear) as a method</span></div><div class="line"><span class="comment">//       to impose a transmission ratio between two</span></div><div class="line"><span class="comment">//       shafts as they were connected by gears, without</span></div><div class="line"><span class="comment">//       the need of performing collision detection between</span></div><div class="line"><span class="comment">//       gear teeth geometries (which would be inefficient)</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//       CHRONO</span></div><div class="line"><span class="comment">//   ------</span></div><div class="line"><span class="comment">//   Multibody dinamics engine</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment">//             http://www.projectchrono.org</span></div><div class="line"><span class="comment">// ------------------------------------------------</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="preprocessor">#include &quot;chrono/core/ChRealtimeStep.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChSystem.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono/physics/ChBodyEasy.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChBodySceneNode.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChBodySceneNodeTools.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;chrono_irrlicht/ChIrrApp.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;irrlicht.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Use the namespaces of Chrono</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono.html">chrono</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechrono_1_1irrlicht.html">chrono::irrlicht</a>;</div><div class="line"></div><div class="line"><span class="comment">// Use the main namespaces of Irrlicht</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr.html">irr</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1core.html">irr::core</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceirr_1_1scene.html">irr::scene</a>;</div><div class="line"><span class="keyword">using namespace </span>irr::video;</div><div class="line"><span class="keyword">using namespace </span>irr::io;</div><div class="line"><span class="keyword">using namespace </span>irr::gui;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">    <span class="comment">// Create a ChronoENGINE physical system</span></div><div class="line">    <a class="code" href="classchrono_1_1_ch_system.html">ChSystem</a> mphysicalSystem;</div><div class="line"></div><div class="line">    <span class="comment">// Create the Irrlicht visualization (open the Irrlicht device,</span></div><div class="line">    <span class="comment">// bind a simple user interface, etc. etc.)</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_app.html">ChIrrApp</a> application(&amp;mphysicalSystem, L<span class="stringliteral">&quot;Gears and pulleys&quot;</span>, core::dimension2d&lt;u32&gt;(800, 600), <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Easy shortcuts to add camera, lights, logo and sky in Irrlicht scene:</span></div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#ae185d295a9a02352688166c2c6665234">ChIrrWizard::add_typical_Logo</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#ab3087fe4418963f09727a91f43562129">ChIrrWizard::add_typical_Sky</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#aa990918e4e1113997fee29ba82083ab1">ChIrrWizard::add_typical_Lights</a>(application.GetDevice());</div><div class="line">    <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_wizard.html#add550a0cc283f166db49d39e50f76c0b">ChIrrWizard::add_typical_Camera</a>(application.GetDevice(), core::vector3df(12, 15, -20));</div><div class="line"></div><div class="line">    <span class="comment">// Create all the rigid bodies.</span></div><div class="line"></div><div class="line">    <span class="keywordtype">double</span> radA = 2;</div><div class="line">    <span class="keywordtype">double</span> radB = 4;</div><div class="line"></div><div class="line">    <span class="comment">// ...the truss</span></div><div class="line">    <span class="keyword">auto</span> mbody_truss = std::make_shared&lt;ChBodyEasyBox&gt;(20, 10, 2, 1000, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(mbody_truss);</div><div class="line">    mbody_truss-&gt;SetBodyFixed(<span class="keyword">true</span>);</div><div class="line">    mbody_truss-&gt;SetPos(ChVector&lt;&gt;(0, 0, 3));</div><div class="line"></div><div class="line">    <span class="comment">// ...a texture asset that will be shared among the four wheels</span></div><div class="line">    <span class="keyword">auto</span> cylinder_texture = std::make_shared&lt;ChTexture&gt;(<a class="code" href="namespacechrono.html#a3bf1da4bd1bc011eeba49d5db828fd53">GetChronoDataFile</a>(<span class="stringliteral">&quot;pinkwhite.png&quot;</span>));</div><div class="line"></div><div class="line">    <span class="comment">// ...the rotating bar support for the two epicycloidal wheels</span></div><div class="line">    <span class="keyword">auto</span> mbody_train = std::make_shared&lt;ChBodyEasyBox&gt;(8, 1.5, 1.0, 1000, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(mbody_train);</div><div class="line">    mbody_train-&gt;SetPos(ChVector&lt;&gt;(3, 0, 0));</div><div class="line"></div><div class="line">    <span class="comment">// ...which must rotate respect to truss along Z axis, in 0,0,0,</span></div><div class="line">    <span class="keyword">auto</span> link_revoluteTT = std::make_shared&lt;ChLinkLockRevolute&gt;();</div><div class="line">    link_revoluteTT-&gt;Initialize(mbody_truss, mbody_train,</div><div class="line">                                <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(0, 0, 0), QUNIT));</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteTT);</div><div class="line"></div><div class="line">    <span class="comment">// ...the first gear</span></div><div class="line">    <span class="keyword">auto</span> mbody_gearA = std::make_shared&lt;ChBodyEasyCylinder&gt;(radA, 0.5, 1000, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(mbody_gearA);</div><div class="line">    mbody_gearA-&gt;SetPos(ChVector&lt;&gt;(0, 0, -1));</div><div class="line">    mbody_gearA-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_X));</div><div class="line">    mbody_gearA-&gt;AddAsset(cylinder_texture);</div><div class="line">    <span class="comment">// for aesthetical reasons, also add a thin cylinder only as a visualization:</span></div><div class="line">    <span class="keyword">auto</span> mshaft_shape = std::make_shared&lt;ChCylinderShape&gt;();</div><div class="line">    mshaft_shape-&gt;GetCylinderGeometry().p1 = ChVector&lt;&gt;(0,-3,0);</div><div class="line">    mshaft_shape-&gt;GetCylinderGeometry().p2 = ChVector&lt;&gt;(0, 10,0);</div><div class="line">    mshaft_shape-&gt;GetCylinderGeometry().rad = radA*0.4;</div><div class="line">    mbody_gearA-&gt;AddAsset(mshaft_shape);</div><div class="line"></div><div class="line">    <span class="comment">// ...impose rotation between the first gear and the fixed truss</span></div><div class="line">    <span class="keyword">auto</span> link_engine = std::make_shared&lt;ChLinkEngine&gt;();</div><div class="line">    link_engine-&gt;Initialize(mbody_gearA, mbody_truss, <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(0, 0, 0), QUNIT));</div><div class="line">    link_engine-&gt;Set_shaft_mode(<a class="code" href="classchrono_1_1_ch_link_engine.html#ac98a88a282435b5459d1fc656319939eafe457c16213e77680fba4f17aeebc0d9">ChLinkEngine::ENG_SHAFT_LOCK</a>);  <span class="comment">// also works as revolute support</span></div><div class="line">    link_engine-&gt;Set_eng_mode(ChLinkEngine::ENG_MODE_SPEED);</div><div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> mfun = std::dynamic_pointer_cast&lt;ChFunction_Const&gt;(link_engine-&gt;Get_spe_funct()))</div><div class="line">        mfun-&gt;Set_yconst(6);  <span class="comment">// rad/s  angular speed</span></div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_engine);</div><div class="line"></div><div class="line">    <span class="comment">// ...the second gear</span></div><div class="line">    <span class="keywordtype">double</span> interaxis12 = radA + radB;</div><div class="line">    <span class="keyword">auto</span> mbody_gearB = std::make_shared&lt;ChBodyEasyCylinder&gt;(radB, 0.4, 1000, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(mbody_gearB);</div><div class="line">    mbody_gearB-&gt;SetPos(ChVector&lt;&gt;(interaxis12, 0, -1));</div><div class="line">    mbody_gearB-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_X));</div><div class="line">    mbody_gearB-&gt;AddAsset(cylinder_texture);</div><div class="line"></div><div class="line">    <span class="comment">// ... the second gear is fixed to the rotating bar</span></div><div class="line">    <span class="keyword">auto</span> link_revolute = std::make_shared&lt;ChLinkLockRevolute&gt;();</div><div class="line">    link_revolute-&gt;Initialize(mbody_gearB, mbody_train,</div><div class="line">                              <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(interaxis12, 0, 0), QUNIT));</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revolute);</div><div class="line"></div><div class="line">    <span class="comment">// ...the gear constraint between the two wheels A and B.</span></div><div class="line">    <span class="comment">//    As transmission ratio (=speed of wheel B / speed of wheel A) to enter in  Set_tau(), we</span></div><div class="line">    <span class="comment">//    could use whatever positive value we want: the ChLinkGear will compute the two radii of the</span></div><div class="line">    <span class="comment">//    wheels for its &#39;hidden&#39; computations, given the distance between the two axes. However, since</span></div><div class="line">    <span class="comment">//    we already build two &#39;3D cylinders&#39; bodies -just for visualization reasons!- with radA and radB,</span></div><div class="line">    <span class="comment">//    we must enter Set_tau(radA/radB).</span></div><div class="line">    <span class="comment">//    Also, note that the initial position of the constraint has no importance (simply use CSYSNORM),</span></div><div class="line">    <span class="comment">//    but we must set where the two axes are placed in the local coordinates of the two wheels, so</span></div><div class="line">    <span class="comment">//    we use Set_local_shaft1() and pass some local ChFrame. Note that, since the Z axis of that frame</span></div><div class="line">    <span class="comment">//    will be considered the axis of the wheel, we must rotate the frame 90° with Q_from_AngAxis(), because</span></div><div class="line">    <span class="comment">//    we created the wheel with ChBodyEasyCylinder() which created a cylinder with Y as axis.</span></div><div class="line">    <span class="keyword">auto</span> link_gearAB = std::make_shared&lt;ChLinkGear&gt;();</div><div class="line">    link_gearAB-&gt;Initialize(mbody_gearA, mbody_gearB, CSYSNORM);</div><div class="line">    link_gearAB-&gt;Set_local_shaft1(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(VNULL, chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_gearAB-&gt;Set_local_shaft2(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(VNULL, chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_gearAB-&gt;Set_tau(radA / radB);</div><div class="line">    link_gearAB-&gt;Set_checkphase(<span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_gearAB);</div><div class="line"></div><div class="line">    <span class="comment">// ...the gear constraint between the second wheel B and a large wheel C with inner teeth, that</span></div><div class="line">    <span class="comment">//    does not necessarily need to be created as a new body because it is the &#39;fixed&#39; part of the</span></div><div class="line">    <span class="comment">//    epicycloidal reducer, so, as wheel C, we will simply use the ground object &#39;mbody_truss&#39;.</span></div><div class="line">    <span class="keywordtype">double</span> radC = 2 * radB + radA;</div><div class="line">    <span class="keyword">auto</span> link_gearBC = std::make_shared&lt;ChLinkGear&gt;();</div><div class="line">    link_gearBC-&gt;Initialize(mbody_gearB, mbody_truss, CSYSNORM);</div><div class="line">    link_gearBC-&gt;Set_local_shaft1(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(VNULL, chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_gearBC-&gt;Set_local_shaft2(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(ChVector&lt;&gt;(0, 0, -4), QUNIT));</div><div class="line">    link_gearBC-&gt;Set_tau(radB / radC);</div><div class="line">    link_gearBC-&gt;Set_epicyclic(<span class="keyword">true</span>);  <span class="comment">// &lt;-- this means: use a wheel with internal teeth!</span></div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_gearBC);</div><div class="line"></div><div class="line">    <span class="comment">// ...the bevel gear at the side,</span></div><div class="line">    <span class="keywordtype">double</span> radD = 5;</div><div class="line">    <span class="keyword">auto</span> mbody_gearD = std::make_shared&lt;ChBodyEasyCylinder&gt;(radD, 0.8, 1000, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(mbody_gearD);</div><div class="line">    mbody_gearD-&gt;SetPos(ChVector&lt;&gt;(-10, 0, -9));</div><div class="line">    mbody_gearD-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">    mbody_gearD-&gt;AddAsset(cylinder_texture);</div><div class="line"></div><div class="line">    <span class="comment">// ... it is fixed to the truss using a revolute joint with horizontal axis (must rotate</span></div><div class="line">    <span class="comment">//     default ChLink creation coordys 90° on the Y vertical, since the revolute axis is the Z axis).</span></div><div class="line">    <span class="keyword">auto</span> link_revoluteD = std::make_shared&lt;ChLinkLockRevolute&gt;();</div><div class="line">    link_revoluteD-&gt;Initialize(mbody_gearD, mbody_truss,</div><div class="line">                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(-10, 0, -9), Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteD);</div><div class="line"></div><div class="line">    <span class="comment">// ... Let&#39;s make a 1:1 gear between wheel A and wheel D as a bevel gear: chrono::engine does not require</span></div><div class="line">    <span class="comment">//     special info for this case -the position of the two shafts and the transmission ratio are enough-</span></div><div class="line">    <span class="keyword">auto</span> link_gearAD = std::make_shared&lt;ChLinkGear&gt;();</div><div class="line">    link_gearAD-&gt;Initialize(mbody_gearA, mbody_gearD, CSYSNORM);</div><div class="line">    link_gearAD-&gt;Set_local_shaft1(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(ChVector&lt;&gt;(0, -7, 0), chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_gearAD-&gt;Set_local_shaft2(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(ChVector&lt;&gt;(0, -7, 0), chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_gearAD-&gt;Set_tau(1);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_gearAD);</div><div class="line"></div><div class="line">    <span class="comment">// ...the pulley at the side,</span></div><div class="line">    <span class="keywordtype">double</span> radE = 2;</div><div class="line">    <span class="keyword">auto</span> mbody_pulleyE = std::make_shared&lt;ChBodyEasyCylinder&gt;(radE, 0.8, 1000, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#ac45b72a2db1176dbed6731e904a18150">Add</a>(mbody_pulleyE);</div><div class="line">    mbody_pulleyE-&gt;SetPos(ChVector&lt;&gt;(-10, -11, -9));</div><div class="line">    mbody_pulleyE-&gt;SetRot(Q_from_AngAxis(CH_C_PI / 2, VECT_Z));</div><div class="line">    mbody_pulleyE-&gt;AddAsset(cylinder_texture);</div><div class="line"></div><div class="line">    <span class="comment">// ... it is fixed to the truss using a revolute joint with horizontal axis (must rotate</span></div><div class="line">    <span class="comment">//     default ChLink creation coordys 90° on the Y vertical, since the revolute axis is the Z axis).</span></div><div class="line">    <span class="keyword">auto</span> link_revoluteE = std::make_shared&lt;ChLinkLockRevolute&gt;();</div><div class="line">    link_revoluteE-&gt;Initialize(mbody_pulleyE, mbody_truss,</div><div class="line">                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(ChVector&lt;&gt;(-10, -11, -9), Q_from_AngAxis(CH_C_PI / 2, VECT_Y)));</div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_revoluteE);</div><div class="line"></div><div class="line">    <span class="comment">// ... Let&#39;s make a synchro belt constraint between pulley D and pulley E. The user must be</span></div><div class="line">    <span class="comment">//     sure that the two shafts are parallel in absolute space. Also, interaxial distance should not change.</span></div><div class="line">    <span class="keyword">auto</span> link_pulleyDE = std::make_shared&lt;ChLinkPulley&gt;();</div><div class="line">    link_pulleyDE-&gt;Initialize(mbody_gearD, mbody_pulleyE, CSYSNORM);</div><div class="line">    link_pulleyDE-&gt;Set_local_shaft1(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(VNULL, chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_pulleyDE-&gt;Set_local_shaft2(<a class="code" href="classchrono_1_1_ch_frame.html">ChFrame&lt;&gt;</a>(VNULL, chrono::Q_from_AngAxis(-CH_C_PI / 2, VECT_X)));</div><div class="line">    link_pulleyDE-&gt;Set_r1(radD);</div><div class="line">    link_pulleyDE-&gt;Set_r2(radE);</div><div class="line">    link_pulleyDE-&gt;Set_checkphase(<span class="keyword">true</span>); <span class="comment">// synchro belts don&#39;t tolerate slipping: this avoids it as numerical errors accumulate.</span></div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_assembly.html#a5f77de6ceee04f99319b0c8014016083">AddLink</a>(link_pulleyDE);</div><div class="line"></div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment">// Use this function for adding a ChIrrNodeAsset to all items</span></div><div class="line">    <span class="comment">// Otherwise use application.AssetBind(myitem); on a per-item basis.</span></div><div class="line">    application.AssetBindAll();</div><div class="line"></div><div class="line">    <span class="comment">// Use this function for &#39;converting&#39; assets into Irrlicht meshes</span></div><div class="line">    application.AssetUpdateAll();</div><div class="line"></div><div class="line">    <span class="comment">// Prepare the physical system for the simulation</span></div><div class="line"></div><div class="line">    mphysicalSystem.<a class="code" href="classchrono_1_1_ch_system.html#ae23e97c84fc621a2e757dfcafe94f9b7">SetIntegrationType</a>(ChSystem::INT_EULER_IMPLICIT_PROJECTED);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="comment">// THE SOFT-REAL-TIME CYCLE</span></div><div class="line">    <span class="comment">//</span></div><div class="line">    application.SetStepManage(<span class="keyword">true</span>);</div><div class="line">    application.SetTimestep(0.01);</div><div class="line">    application.SetTryRealtime(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (application.GetDevice()-&gt;run()) {</div><div class="line">        application.GetVideoDriver()-&gt;beginScene(<span class="keyword">true</span>, <span class="keyword">true</span>, SColor(255, 140, 161, 192));</div><div class="line"></div><div class="line">        application.DrawAll();</div><div class="line"></div><div class="line">        <span class="comment">// .. draw also some circle lines representing gears - just for aesthetical reasons</span></div><div class="line"></div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#af2e27797df2d4453d6ddcdc608180561">ChIrrTools::drawCircle</a>(application.GetVideoDriver(), link_gearBC-&gt;Get_r2(),</div><div class="line">                               (link_gearBC-&gt;Get_local_shaft2() &gt;&gt; *link_gearBC-&gt;GetBody2()).GetCoord(),</div><div class="line">                               video::SColor(255, 255, 0, 0), 50, <span class="keyword">true</span>);</div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#af2e27797df2d4453d6ddcdc608180561">ChIrrTools::drawCircle</a>(application.GetVideoDriver(), link_gearAD-&gt;Get_r1(),</div><div class="line">                               (link_gearAD-&gt;Get_local_shaft1() &gt;&gt; *link_gearAD-&gt;GetBody1()).GetCoord(),</div><div class="line">                               video::SColor(255, 255, 0, 0), 30, <span class="keyword">true</span>);</div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#af2e27797df2d4453d6ddcdc608180561">ChIrrTools::drawCircle</a>(application.GetVideoDriver(), link_gearAD-&gt;Get_r2(),</div><div class="line">                               (link_gearAD-&gt;Get_local_shaft2() &gt;&gt; *link_gearAD-&gt;GetBody2()).GetCoord(),</div><div class="line">                               video::SColor(255, 255, 0, 0), 30, <span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#af2e27797df2d4453d6ddcdc608180561">ChIrrTools::drawCircle</a>(application.GetVideoDriver(), 0.1,</div><div class="line">                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(link_gearAB-&gt;GetMarker2()-&gt;GetAbsCoord().pos, QUNIT));</div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#af2e27797df2d4453d6ddcdc608180561">ChIrrTools::drawCircle</a>(application.GetVideoDriver(), 0.1,</div><div class="line">                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(link_gearAD-&gt;GetMarker2()-&gt;GetAbsCoord().pos, QUNIT));</div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#af2e27797df2d4453d6ddcdc608180561">ChIrrTools::drawCircle</a>(application.GetVideoDriver(), 0.1,</div><div class="line">                               <a class="code" href="classchrono_1_1_ch_coordsys.html">ChCoordsys&lt;&gt;</a>(link_gearBC-&gt;GetMarker2()-&gt;GetAbsCoord().pos, QUNIT));</div><div class="line"></div><div class="line">        <span class="comment">// ..draw also some segments for a simplified representation of pulley</span></div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#ac0844abf707003b0490c37e78de36651">ChIrrTools::drawSegment</a>(application.GetVideoDriver(), link_pulleyDE-&gt;Get_belt_up1(),</div><div class="line">                                link_pulleyDE-&gt;Get_belt_up2(), video::SColor(255, 0, 255, 0), <span class="keyword">true</span>);</div><div class="line">        <a class="code" href="classchrono_1_1irrlicht_1_1_ch_irr_tools.html#ac0844abf707003b0490c37e78de36651">ChIrrTools::drawSegment</a>(application.GetVideoDriver(), link_pulleyDE-&gt;Get_belt_low1(),</div><div class="line">                                link_pulleyDE-&gt;Get_belt_low2(), video::SColor(255, 0, 255, 0), <span class="keyword">true</span>);</div><div class="line"></div><div class="line">        <span class="comment">// ADVANCE THE SIMULATION FOR ONE STEP</span></div><div class="line"></div><div class="line">        application.DoStep();</div><div class="line"></div><div class="line">        application.GetVideoDriver()-&gt;endScene();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 1 2016 15:43:11 for Project Chrono by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11 . <a href="mailto:info@projectchrono.org">Contact us</a> for issues related to this page. 
</small></address>
</body>
</html>
